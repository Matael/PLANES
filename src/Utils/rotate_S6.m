function C_out=rotate_S6(C,Q)

R1 = [ Q(1,1).^2 Q(1,2).^2 Q(1,3).^2 ; ...
       Q(2,1).^2 Q(2,2).^2 Q(2,3).^2 ; ...
       Q(3,1).^2 Q(3,2).^2 Q(3,3).^2 ] ;

R2 = [ Q(1,2).*Q(1,3) Q(1,3).*Q(1,1) Q(1,1).*Q(1,2) ; ...
       Q(2,2).*Q(2,3) Q(2,3).*Q(2,1) Q(2,1).*Q(2,2) ; ...
       Q(3,2).*Q(3,3) Q(3,3).*Q(3,1) Q(3,1).*Q(3,2) ] ;

R3 = [ Q(2,1).*Q(3,1) Q(2,2).*Q(3,2) Q(2,3).*Q(3,3) ; ...
       Q(3,1).*Q(1,1) Q(3,2).*Q(1,2) Q(3,3).*Q(1,3) ; ...
       Q(1,1).*Q(2,1) Q(1,2).*Q(2,2) Q(1,3).*Q(2,3) ] ;

R4 = [ Q(2,2).*Q(3,3)+Q(2,3).*Q(3,2) ...
                     Q(2,3).*Q(3,1)+Q(2,1).*Q(3,3) ...
                                 Q(2,1).*Q(3,2)+Q(2,2).*Q(3,1) ; ...
       Q(3,2).*Q(1,3)+Q(3,3).*Q(1,2) ...
                     Q(3,3).*Q(1,1)+Q(3,1).*Q(1,3) ...
                                 Q(3,1).*Q(1,2)+Q(3,2).*Q(1,1) ; ...      
       Q(1,2).*Q(2,3)+Q(1,3).*Q(2,2) ...
                     Q(1,3).*Q(2,1)+Q(1,1).*Q(2,3) ...
                                 Q(1,1).*Q(2,2)+Q(1,2).*Q(2,1)] ; 

A = [ R1  2*R2 ; R3   R4   ] ;

C_out=A * C * A';